<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DKBat Invoice</title>

<style>
body { font-family: Arial; background:#f2f2f2; }
#invoice {
  width:210mm;
  min-height:297mm;
  background:#fff;
  margin:auto;
  padding:20mm;
}
button {
  padding:10px 16px;
  margin:10px;
  font-size:15px;
}
@media print {
  button { display:none; }
}
</style>
</head>

<body>

<div id="invoice">
  <center>
    <img src="https://i.imgur.com/1Q9Z1Zm.png" width="120"><br>
    <h2>DKBat Massage Invoice</h2>
  </center>

  <p><b>Name:</b> <span id="name"></span></p>
  <p><b>Service:</b> <span id="service"></span></p>
  <p><b>Status:</b> <span id="status"></span></p>
  <p><b>Date:</b> <span id="date"></span></p>
  <p><b>Time:</b> <span id="time"></span></p>

  <p><b>Amount:</b> â‚¹999</p>
</div>

<center>
  <button onclick="printInvoice()">ðŸ–¨ Print / Save PDF</button>
  <button onclick="shareWhatsApp()">ðŸ“² Share on WhatsApp</button>
</center>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  databaseURL:
    "https://dkbat-orders-default-rtdb.asia-southeast1.firebasedatabase.app"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const params = new URLSearchParams(window.location.search);
const orderId = params.get("id");

let orderData = null;

get(ref(db, "orders/" + orderId)).then(snapshot => {
  orderData = snapshot.val();
  if (!orderData) return;

  name.innerText = orderData.name || "-";
  service.innerText = orderData.service || "-";
  status.innerText = orderData.status || "Pending";
  date.innerText = orderData.date || "-";
  time.innerText = orderData.time || "-";
});

window.printInvoice = () => window.print();

window.shareWhatsApp = function () {
  if (!orderData) return;

  const msg = `
ðŸ§¾ *DKBat Massage Invoice*

ðŸ‘¤ ${orderData.name}
ðŸ’† ${orderData.service}
ðŸ“Œ ${orderData.status}

ðŸ”— ${window.location.href}
`;

  window.open(
    "https://wa.me/?text=" + encodeURIComponent(msg),
    "_blank"
  );
};
</script>

</body>
</html>
